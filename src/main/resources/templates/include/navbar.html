<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1000/xhtml">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!--     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
 -->
  
<!-- 	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
 -->
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <title>Atooly</title>
</head>
<style>
  .navbar-toggler{
    background-color: red !important;
      border-radius: 13px;
  } 
 .dropdown-item:hover{
       transition: 3s;
          	font-size:14px;
	        font-weight:500;
	        color: #6FB70F !important;
 }
 .nav-link{
    	text-transform:uppercase;
            transition: 3s;
          	font-size:14px;
	        font-weight:500;
	        color: #ffffff !important;
  }
  .nav-link:hover{
   	background-color:#6FB70F;
 }
  .searchBar > input{
    border-radius: 13px;
  }

  @media screen and (min-width:1025px) {
     .nav-item dropdown{
      text-align: right; 
    }
   
   .welcome {
      margin-left: 3rem;
    }
   .searchBar{
     width: 30rem !important;
      margin-left: 5rem;  
    }
    
   .contact{
     margin-left: 2rem;  
    }
   .myAccount{
         margin-left: 8.6rem;
     } 
     
  
    .shopping-cart{
       margin-left: 6rem;
     }
  }
  @media (min-width: 768px) and (max-width: 1024px) {
    .searchBar{
      width: 30rem;
    }
  }
  @media screen and (max-width:456px) {
    .nav-item dropdown{
      text-align: left; 
    }
  }
 
</style>
<body>

<!--    <nav class="navbar navbar-expand-lg navbar-light bg-light">
 -->  

    <nav class="navbar navbar-expand-lg navbar-light fixed-top" style="background-color: #2F2F2C;">
 
     <a th:href="@{/}" class="navbar-brand"> 
         <img  th:src="@{${awsBucketIcon}+'logo.png'}"  alt="logo" height="39px;" />
     </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto" >
  <!--     <li class="nav-item active welcome">
        <a class="nav-link" th:href="@{/}"
        >Accueil <span class="sr-only">(current)</span></a>
      </li> -->
<!-- 	  <form class="form-inline my-2 my-lg-0 searchBar">
	     <input class="form-control mr-sm-2"  style="border-radius: 13px;width: 20rem;"
	      type="search" placeholder="Entrer votre recherche" aria-label="Search">
	     <button class="btn btn-white my-2 my-sm-0 searchButton" 
	      style="border-radius: 13px;"
	      type="submit">Rechercher</button>
	  </form> -->
		<form class="form-inline active-purple-4 searchBar">
		  <input class="form-control form-control-sm mr-3 w-75"
		   type="text" placeholder="Entrer votre recherche"
		    aria-label="Search" id="search" name="search">
		  <i class="fa fa-search text-white" aria-hidden="true"></i>
    </form>

      <li class="nav-item contact">
        <a class="nav-link text-white" th:href="@{/contact}">Contact</a>
      </li>
  
      <li class="nav-item shopping-cart">
         <a class="nav-link" th:href="@{/cart/all}">
        <i class="fa fa-shopping-cart" 
                   style="font-size: 1.7rem;"
               aria-hidden="true"></i>
                  <span 
                     th:if="${bookingAddedToCartExist==true}"
                     style="color:#6FB70F;"
                    th:text="${bookingAddedToCartList.size}"
                  ></span>
                  <span 
                     th:if="${bookingAddedToCartExist !=true}"
                     style="color:#6FB70F;"
                  >0</span> 
         </a>
      </li> 
      <li class="nav-item dropdown myAccount">
        <a class="nav-link dropdown-toggle text-white"
         href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fa fa-users" aria-hidden="true"></i> Mon compte
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" th:href="@{/login}"> <i class="fa fa-sign-in" aria-hidden="true"></i> 
            <span>Se connecter</span>
           </a>
          <a class="dropdown-item" th:href="@{/createAccount}"><i class="fa fa-user-o"></i> 
            <span>Cr√©er un compte</span>
          </a>
        </div>
       </li> 
    </ul>
  </div>
</nav>
<div style="background-color: black; margin-left: 1rem;" id="dumppy"></div>

<script th:src="@{/assets/js/vendor/jquery-3.2.1.min.js}"></script>

<script>
  $(document).ready(function(){
      $("#search").keyup(function(){
      
      var query=$(this).val();
      if(query!='')
      {
           $.ajax({
            type: "GET",
	          contentType: "application/json",
	          url: '/search/products?keyword='+query,
	          data: {},
	          dataType: 'json',
	          cache: false,
	          timeout: 600000,
	          success: function (data) {
              var json = data.result;
              console.log(json);
              $.each(json,function(index,product){
                if(product.galery !=null && product.category.title =='service'){
                  $('#dumppy').html('');    
                  $("nav div").hide();
                  $('#dumppy').append(
                  '<div class="row" style="margin-top:4.5rem;">'+ 
                      '<div class="col-xs-12">'
                      +'<img class="rounded-circle" style="width:80px; height:8px" src='+ data.awsBucketProduct+product.galery.id + '/'+ product.galery.image1 +' alt="picture">'
                    +'</div>'   
                    +'<div class="col-xs-12" style="display:inline;margin-left:1rem; cursor:pointer;" onclick="getResultDumppy('+product.id+')">'
                      +'<span class="text-success">' + product.name+'</span>'+'<br>'
                      +'<span class="text-danger">' +product.price+ ' xof'+'</span>' 
                    +'</div>'
                  +"</div>"   
                 );
                }
                if(product.galery !=null && product.category.title =='store'){
                  $('#dumppy').html('');    
                  $("nav div").hide();
                  $('#dumppy').append( 
                  '<div class="row" style="margin-top:4.5rem;">'+ 
                      '<div class="col-xs-12">'
                      +'<img class="rounded-circle" style="width:80px; height:80px" src='+ data.awsBucketProduct+product.galery.id + '/'+ product.galery.image1 +' alt="picture">'
                      +'</div>'   
                      +'<div class="col-xs-12" style="display:inline;margin-left:1rem;cursor:pointer;" onclick="getResultDumppy('+product.id+')">'
                        +'<span class="text-success">' + product.name+'</span>'+'<br>'
                        +'<span class="text-danger">' +product.price+' xof'+'</span>'
                      +'</div>'
                    +"</div>"   
                   
                 );
                }
                if(product.galery !=null && product.category.title =='shop'){
                  $('#dumppy').html('');    
                  $("nav div").hide();
                  $('#dumppy').append(
                  '<div class="row" style="margin-top:4.5rem;">'+ 
                      '<div class="col-xs-12">'
                      +'<img class="rounded-circle" style="width:80px; height:80px" src='+ data.awsBucketShop+product.galery.id + '/'+ product.galery.image1 +' alt="picture">'
                    +'</div>'   
                    +'<div class="col-xs-12" style="display:inline;margin-left:1rem;cursor: pointer;" onclick="getResultDumppy('+product.id+')">'
                      +'<span class="text-success">' + product.name+'</span>'+'<br>'
                      +'<span class="text-danger">' +product.price+' xof'+'</span>' 
                    +'</div>'
                   
                  +"</div>"   
               );
              }
              if(product.galery !=null && product.category.title == 'groupSale'){
                $('#dumppy').html('');    
                $("nav div").hide();
                  $('#dumppy').append(
                  '<div class="row" style="margin-top:4.5rem;">'+ 
                      '<div class="col-xs-12">'
                      +'<img class="rounded-circle" style="width:80px; height:80px" src='+ data.awsBucketGroupSale+product.galery.id + '/'+ product.galery.image1 +' alt="picture">'
                    +'</div>'   
                    +'<div class="col-xs-12" style="display:inline; margin-left:1rem; cursor:pointer;" onclick="getResultDumppy('+product.id+')">'
                      +'<span class="text-success">' + product.name+'</span>'+'<br>'
                      +'<span class="text-danger">' +product.price+' xof'+'</span>' 
                    +'</div>'  
                  +"</div>"   
               );
              }
              
            });
          },
             
	          error: function (e) {
	            console.log("ERROR : ", e);
	          }
          });
      }
      });
  });

 
</script>

<script>
   function getResultDumppy(productId){
    	$.ajax({
			type: "GET",
	        contentType: "application/json",
	        url: '/search/findProduct?product_id='+productId,
	        data: {},
	        dataType: 'json',
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
            window.location.href = '/search/resultsProduct/'+data.id+'/'+data.name;
	        },
	        error: function (e) {
	            console.log("ERROR : ", e);
	        }
		});  
     }
</script> 
</body>
</html>